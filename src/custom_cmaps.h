/**
# Additional colormaps for bview

* *seismic*: blue-to-red diverging map extracted from [matplotlib](https://matplotlib.org/stable/tutorials/colors/colormaps.html), good
for plotting vorticity field.
* *black_body*: sequential black-to-yellow colormap, useful for
the temperature field in combustion simulations (from [rt.c](http://basilisk.fr/sandbox/Antoonvh/rt.c))
*/

void seismic (double cmap[NCMAP][3])
{
  static double basemap[33][3] = {
    {0.000000, 0.000000, 0.300000},
    {0.000000, 0.000000, 0.387843},
    {0.000000, 0.000000, 0.475686},
    {0.000000, 0.000000, 0.563529},
    {0.000000, 0.000000, 0.651373},
    {0.000000, 0.000000, 0.739216},
    {0.000000, 0.000000, 0.827059},
    {0.000000, 0.000000, 0.914902},
    {0.003922, 0.003922, 1.000000},
    {0.129412, 0.129412, 1.000000},
    {0.254902, 0.254902, 1.000000},
    {0.380392, 0.380392, 1.000000},
    {0.505882, 0.505882, 1.000000},
    {0.631373, 0.631373, 1.000000},
    {0.756863, 0.756863, 1.000000},
    {0.882353, 0.882353, 1.000000},
    {1.000000, 0.992157, 0.992157},
    {1.000000, 0.866667, 0.866667},
    {1.000000, 0.741176, 0.741176},
    {1.000000, 0.615686, 0.615686},
    {1.000000, 0.490196, 0.490196},
    {1.000000, 0.364706, 0.364706},
    {1.000000, 0.239216, 0.239216},
    {1.000000, 0.113725, 0.113725},
    {0.994118, 0.000000, 0.000000},
    {0.931373, 0.000000, 0.000000},
    {0.868627, 0.000000, 0.000000},
    {0.805882, 0.000000, 0.000000},
    {0.743137, 0.000000, 0.000000},
    {0.680392, 0.000000, 0.000000},
    {0.617647, 0.000000, 0.000000},
    {0.554902, 0.000000, 0.000000},
    {0.500000, 0.000000, 0.000000},
  };

  for (int i = 0; i < NCMAP; i++) {
    double x = i*(32 - 1e-10)/(NCMAP - 1);
    int j = x; x -= j;
    for (int k = 0; k < 3; k++)
      cmap[i][k] = (1. - x)*basemap[j][k] + x*basemap[j+1][k];
  }
}

void black_body (double cmap[NCMAP][3])
{
  static double basemap[33][3] = {
    {0.0,0.0,0.0},
    {0.0857913205762,0.0309874526184,0.0173328711915},
    {0.133174636606, 0.0588688899571,0.0346802666087},
    {0.180001956037,0.0730689545154,0.0515393237212},
    {0.22981556179,0.0840603593119,0.0647813713857},
    {0.281397607223,0.093912584278,0.075408501413},
    {0.334521638801,0.102639499627,0.0842454688083},
    {0.388957802186,0.110254429637,0.0927990674821},
    {0.444611925648,0.116732501721,0.101402659637},
    {0.501422312285,0.122025816585,0.110058408122},
    {0.559331322331,0.126067584009,0.118767796491},
    {0.618285970576,0.128767919785,0.127531801155},
    {0.678237857955,0.130007052818,0.136351016263},
    {0.712849583079,0.181721849923,0.13081678256},
    {0.743632057947,0.232649759358,0.120991817028},
    {0.774324938583,0.279315911516,0.108089917959},
    {0.804936242903,0.323627020047,0.0907961686083},
    {0.835473266757,0.366524681419,0.0662363460741},
    {0.865942668698,0.408541395043,0.026029485466},
    {0.876634426153,0.46401951695,0.0173065426095},
    {0.883455346031,0.518983528803,0.0149628730405},
    {0.88905246237,0.572164381169,0.013499801006},
    {0.893375939063,0.624108797455,0.0130334871745},
    {0.89637036663,0.675180034619,0.013680092215},
    {0.897973818846,0.725630730259,0.015555776796},
    {0.898116710502,0.775642817733,0.0187767015864},
    {0.896720396485,0.825350944866,0.023459027255},
    {0.927670131094,0.859991226192,0.319086199143},
    {0.956158602738,0.893933112845,0.503316730316},
    {0.97827065392,0.92856476667,0.671307024002},
    {0.993196411712,0.963913323002,0.83560909192},
    {1.0,1.0,1.0},
  };

  for (int i = 0; i < NCMAP; i++) {
    double x = i*(31 - 1e-10)/(NCMAP - 1);
    int j = x; x -= j;
    for (int k = 0; k < 3; k++)
      cmap[i][k] = (1. - x)*basemap[j][k] + x*basemap[j+1][k];
  }
}

